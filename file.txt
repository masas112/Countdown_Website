// Membuat elemen informasi kecil di sudut kanan atas
var countdownElement = document.createElement("div");
countdownElement.id = "countdownElement";
countdownElement.style.position = "fixed";
countdownElement.style.top = "10px";
countdownElement.style.right = "10px";
countdownElement.style.backgroundColor = "rgba(255, 255, 255, 0.9)";
countdownElement.style.padding = "10px";
countdownElement.style.border = "1px solid #ccc";
countdownElement.style.boxShadow = "0 0 5px rgba(0, 0, 0, 0.1)";
countdownElement.style.zIndex = "9999";

// Menambahkan konten informasi kecil
var countdownElementContent = document.createElement("p");
countdownElementContent.innerText = "Informasi Waktu";
countdownElement.appendChild(countdownElementContent);

// Menambahkan elemen ke dalam body
document.body.appendChild(countdownElement);


var waktuSisa = 35;
var closeTab = false;

function updateCountdown() {

    countdownElement.innerText = "Countdown: " + waktuSisa + " detik";

    waktuSisa--;

    if (waktuSisa < 0) {
        clearInterval(countdownInterval);
        countdownElement.innerText = "Waktu habis!";
        // Membuat elemen overlay
        var overlayElement = document.createElement("div");
        overlayElement.id = "overlay";
        overlayElement.style.position = "fixed";
        overlayElement.style.top = "0";
        overlayElement.style.left = "0";
        overlayElement.style.width = "100%";
        overlayElement.style.height = "100%";
        overlayElement.style.backgroundColor = "rgba(255, 255, 255, 0.8)";
        overlayElement.style.zIndex = "9999";
        overlayElement.style.display = "flex";
        overlayElement.style.alignItems = "center";
        overlayElement.style.justifyContent = "center";

        // Menambahkan form password
        var passwordForm = document.createElement("form");
        passwordForm.addEventListener("submit", function (event) {
            event.preventDefault();
            var passwordInput = document.getElementById("passwordInput");
            var enteredPassword = passwordInput.value;

            // Gantilah "your_password" dengan kata sandi yang diinginkan
            if (enteredPassword === "coba") {
                document.body.removeChild(overlayElement);
            } else {
                alert("Kata sandi salah!");
            }
        });

        var textLabel = document.createElement("label");
        textLabel.innerText = "WAKTU ANDA SUDAH HABIS!!\n\n";
        textLabel.style.fontSize = "35px";
        textLabel.style.fontWeight = "bold";
        textLabel.style.alignContent = "center";
        passwordForm.appendChild(textLabel);

        var passwordInput = document.createElement("input");
        passwordInput.type = "password";
        passwordInput.id = "passwordInput";
        passwordInput.placeholder = "Masukkan kata sandi";
        passwordInput.alignContent = "center";
        passwordForm.appendChild(passwordInput);

        var submitButton = document.createElement("button");
        submitButton.type = "submit";
        submitButton.innerText = "Buka Kunci";
        passwordForm.appendChild(submitButton);

        overlayElement.appendChild(passwordForm);

        // Menambahkan overlay ke dalam body
        document.body.appendChild(overlayElement);


    }
}

var countdownInterval = setInterval(updateCountdown, 1000);
window.onload = updateCountdown;


